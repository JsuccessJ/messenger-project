<!DOCTYPE html>
<html>
    <head>
        <title>ì´ˆê°„ë‹¨ ë©”ì‹ ì €</title>
        <style>
            body { font-family: sans-serif; }
            #messages { list-style-type: none; margin: 0; padding: 0; border: 1px solid #ddd; height: 300px; overflow-y: scroll; }
            #messages li { padding: 8px 12px; }
            #messages li:nth-child(odd) { background: #f9f9f9; }
            #form { background: #eee; padding: 5px; position: fixed; bottom: 0; width: 98%; }
            #input { border: 1px solid #ddd; padding: 10px; width: 85%; }
            button { width: 10%; background: #007bff; color: white; border: none; padding: 12px; }
            .info { color: #888; font-style: italic; text-align: center; } /* ğŸ‘ˆ ì•Œë¦¼ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
        </style>
    </head>
    <body>
        <h1>ì‹¤ì‹œê°„ ê³µê°œ ì±„íŒ…ë°©</h1>
        <ul id="messages"></ul>
        <form id="form" action="">
            <input id="input" autocomplete="off" /><button>ì „ì†¡</button>
        </form>

        <script>
            // âœ¨ 1. ì ‘ì† ì‹œ ì‚¬ìš©ì ì´ë¦„ ì…ë ¥ë°›ê¸°
            const clientId = prompt("ì±„íŒ…ì—ì„œ ì‚¬ìš©í•  ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”:");

            // ì´ë¦„ì´ ì—†ìœ¼ë©´ ì ‘ì† ë¶ˆê°€
            if (!clientId) {
                alert("ë‹‰ë„¤ì„ì´ í•„ìš”í•©ë‹ˆë‹¤!");
                window.location.reload();
            }

            // âœ¨ 2. ì›¹ì†Œì¼“ ì£¼ì†Œì— ì‚¬ìš©ì ì´ë¦„ì„ í¬í•¨í•˜ì—¬ ì—°ê²°
            // const ws = new WebSocket(`ws://localhost:8000/ws/${clientId}`);
            const ws = new WebSocket(`wss://lakisha-nonathletic-exie.ngrok-free.dev/ws/${clientId}`);

            const messages = document.getElementById('messages');
            const form = document.getElementById('form');
            const input = document.getElementById('input');

            ws.onmessage = function(event) {
                const li = document.createElement('li');
                
                // âœ¨ 3. ì…ì¥/í‡´ì¥ ì•Œë¦¼ ë©”ì‹œì§€ëŠ” ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ ì ìš©
                if (event.data.startsWith('ğŸ“¢')) {
                    li.classList.add('info');
                }

                li.textContent = event.data;
                messages.appendChild(li);
                messages.scrollTop = messages.scrollHeight;
            };

            form.onsubmit = function(event) {
                event.preventDefault();
                if (input.value) {
                    ws.send(input.value);
                    input.value = '';
                }
            };
        </script>
    </body>
</html>